# Windows 系统设置指南

## 系统要求

- Windows 10 或更高版本
- Python 3.7 或更高版本
- 至少 2GB 可用内存
- 至少 500MB 可用磁盘空间

## 安装步骤

### 1. 安装 Python

1. 访问 [Python 官网](https://www.python.org/downloads/)
2. 下载最新版本的 Python（推荐 3.11 或更高版本）
3. 运行安装程序，**重要：勾选 "Add Python to PATH"**
4. 完成安装

### 2. 验证安装

打开命令提示符（CMD）或 PowerShell，输入：
```cmd
python --version
pip --version
```

如果显示版本信息，说明安装成功。

## 启动方式

### 方式一：双击启动（推荐）

#### 使用批处理脚本
1. 双击 `start_windows.bat` 文件
2. 脚本会自动：
   - 检查 Python 环境
   - 安装项目依赖
   - 创建必要的数据目录
   - 查找可用端口
   - 启动服务器
   - 自动打开浏览器

#### 使用图形界面启动器
1. 双击 `start_windows.pyw` 文件
2. 在图形界面中点击"启动服务"
3. 等待启动完成，程序会自动打开浏览器

### 方式二：命令行启动

1. 打开命令提示符（CMD）
2. 切换到项目目录：
   ```cmd
   cd C:\path\to\AnswerCustomer
   ```
3. 运行启动脚本：
   ```cmd
   python init_and_run.py
   ```

### 方式三：创建可执行文件

1. 运行可执行文件生成器：
   ```cmd
   python create_windows_exe.py
   ```
2. 等待构建完成
3. 双击 `dist/AnswerCustomer/AnswerCustomer.exe` 启动

## 使用说明

### 首次启动

1. 程序会自动创建默认管理员账户：
   - 用户名：admin
   - 密码：admin123

2. 首次登录后请立即修改密码

### 访问地址

- 本地访问：http://localhost:5000
- 局域网访问：http://你的IP地址:5000

### 端口说明

- 默认端口：5000
- 如果端口被占用，程序会自动使用 5001-5009 中的可用端口
- 可以在启动时看到实际使用的端口号

## 故障排除

### 常见问题

#### 1. Python 未找到
**错误信息**：`'python' 不是内部或外部命令`
**解决方案**：
- 重新安装 Python，确保勾选 "Add Python to PATH"
- 或者手动添加 Python 到系统环境变量

#### 2. 依赖安装失败
**错误信息**：`依赖安装失败`
**解决方案**：
- 检查网络连接
- 尝试使用国内镜像源：
  ```cmd
  pip install -r requirements.txt -i https://pypi.tuna.tsinghua.edu.cn/simple/
  ```

#### 3. 端口被占用
**错误信息**：`无法找到可用端口`
**解决方案**：
- 关闭占用端口的其他程序
- 或者手动指定端口：
  ```cmd
  python run.py --port 8080
  ```

#### 4. 权限不足
**错误信息**：`拒绝访问`
**解决方案**：
- 以管理员身份运行命令提示符
- 或者将项目放在用户目录下

### 日志查看

如果遇到问题，可以查看以下日志：
- 控制台输出的错误信息
- `data/` 目录下的日志文件（如果有）

### 重置数据

如果需要重置所有数据：
1. 停止程序
2. 删除 `data/` 目录
3. 重新启动程序

## 高级配置

### 自定义端口

编辑 `start_windows.bat` 文件，修改端口范围：
```batch
for /l %%i in (8080,1,8089) do (
```

### 自定义启动参数

编辑 `run.py` 文件，修改默认配置：
```python
if __name__ == '__main__':
    app.run(host='0.0.0.0', port=5000, debug=True)
```

### 后台运行

使用 Windows 服务或任务计划程序将程序设置为开机自启动。

## 技术支持

如果遇到其他问题，请：
1. 查看控制台错误信息
2. 检查 Python 和依赖版本
3. 确认防火墙设置
4. 联系技术支持

## 更新说明

- 程序会自动检查并安装最新依赖
- 数据文件格式向后兼容
- 建议定期备份 `data/` 目录 